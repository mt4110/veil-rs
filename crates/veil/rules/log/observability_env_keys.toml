# Observability surface: environment variable key names.
# Mask key names like SENTRY_DSN / DD_API_KEY / OTEL_* to hide toolchain wiring.

[[rules]]
id = "log.obs.env_keys"
pattern = '(?i)\b(?:SENTRY_DSN|SENTRY_AUTH_TOKEN|SENTRY_ORG|SENTRY_PROJECT|SENTRY_URL|SENTRY_RELEASE|SENTRY_ENVIRONMENT|SENTRY_TRACES_SAMPLE_RATE|SENTRY_PROFILES_SAMPLE_RATE|DD_API_KEY|DD_APP_KEY|DD_SITE|DD_SERVICE|DD_ENV|DD_VERSION|DD_TRACE_ENABLED|DD_TRACE_AGENT_URL|DD_LOGS_INJECTION|DD_LOGS_CONFIG_PROCESSING_RULES|DD_DOGSTATSD_URL|NEW_RELIC_LICENSE_KEY|NEW_RELIC_API_KEY|NEW_RELIC_APP_NAME|NR_LICENSE_KEY|NR_API_KEY|ELASTIC_APM_SERVER_URL|ELASTIC_APM_SECRET_TOKEN|ELASTIC_APM_API_KEY|ELASTIC_APM_SERVICE_NAME|ELASTIC_APM_ENVIRONMENT|SPLUNK_HEC_TOKEN|SPLUNK_HEC_URL|SUMOLOGIC_ACCESSID|SUMOLOGIC_ACCESSKEY|HONEYCOMB_API_KEY|HONEYCOMB_DATASET|LIGHTSTEP_ACCESS_TOKEN|INSTANA_AGENT_KEY|WAVEFRONT_API_TOKEN|PAGERDUTY_API_TOKEN|OPSGENIE_API_KEY|GRAFANA_CLOUD_API_KEY|GRAFANA_CLOUD_LOKI_URL|GRAFANA_CLOUD_PROMETHEUS_URL|LOKI_URL|LOKI_USERNAME|LOKI_PASSWORD|PROMETHEUS_REMOTE_WRITE_URL|PROMETHEUS_REMOTE_WRITE_USERNAME|PROMETHEUS_REMOTE_WRITE_PASSWORD|OTEL_SERVICE_NAME|OTEL_RESOURCE_ATTRIBUTES|OTEL_EXPORTER_OTLP_ENDPOINT|OTEL_EXPORTER_OTLP_HEADERS|OTEL_EXPORTER_OTLP_PROTOCOL|OTEL_TRACES_EXPORTER|OTEL_METRICS_EXPORTER|OTEL_LOGS_EXPORTER|JAEGER_ENDPOINT|JAEGER_AGENT_HOST|ZIPKIN_ENDPOINT|FLUENTD_CONF|FLUENT_BIT_CONFIG|VECTOR_CONFIG|LOGSTASH_HOST|KIBANA_URL|OPENSEARCH_HOSTS|OPENSEARCH_DASHBOARDS_URL)\b|\b(?:SENTRY|DD|NEW_RELIC|NR|ELASTIC_APM|OTEL|JAEGER|ZIPKIN|GRAFANA|LOKI|PROMETHEUS|SPLUNK|SUMOLOGIC|HONEYCOMB|LIGHTSTEP|INSTANA)_[A-Z0-9_]{2,80}\b'
description = "Observability-related env key names (explicit + vendor prefixes)"
severity = "low"
score = 30
base_score = 30
category = "observability"
tags = ["log", "observability", "env", "keys"]
placeholder = "<REDACTED:OBSERVABILITY>"
context_lines_before = 0
context_lines_after = 0
