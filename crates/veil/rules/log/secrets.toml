# Log SECRET scrubbing rules (tokens/keys/credentials).
# Placeholder is fixed to <REDACTED:SECRET>. Details go to tags.

[[rules]]
id = "log.secret.github.token"
pattern = '\b(?:ghp|gho|ghu|ghs|ghr)_[A-Za-z0-9]{36}\b|\bgithub_pat_[A-Za-z0-9_]{20,200}\b'
description = "GitHub token (classic + fine-grained)"
severity = "high"
score = 90
base_score = 90
category = "secret"
tags = ["log", "secret", "github", "token"]
placeholder = "<REDACTED:SECRET>"
context_lines_before = 1
context_lines_after = 1

[[rules]]
id = "log.secret.gitlab.token"
pattern = '\bglpat-[A-Za-z0-9_-]{20,200}\b'
description = "GitLab personal access token"
severity = "high"
score = 90
base_score = 90
category = "secret"
tags = ["log", "secret", "gitlab", "token"]
placeholder = "<REDACTED:SECRET>"
context_lines_before = 1
context_lines_after = 1

[[rules]]
id = "log.secret.slack.token"
pattern = '\bxox(?:b|p|a|r|s)-[0-9A-Za-z-]{10,200}\b'
description = "Slack token (xox*)"
severity = "high"
score = 88
base_score = 88
category = "secret"
tags = ["log", "secret", "slack", "token"]
placeholder = "<REDACTED:SECRET>"
context_lines_before = 1
context_lines_after = 1

[[rules]]
id = "log.secret.jwt"
pattern = '\beyJ[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_-]{10,}\b'
description = "JWT (3-part base64url)"
severity = "medium"
score = 75
base_score = 75
category = "secret"
tags = ["log", "secret", "jwt"]
placeholder = "<REDACTED:SECRET>"
context_lines_before = 1
context_lines_after = 1

[[rules]]
id = "log.secret.bearer"
pattern = '(?i)\bBearer\s+[A-Za-z0-9._~+/=-]{20,}\b'
description = "Bearer token (Authorization header style)"
severity = "high"
score = 85
base_score = 85
category = "secret"
tags = ["log", "secret", "authz", "bearer"]
placeholder = "<REDACTED:SECRET>"
context_lines_before = 1
context_lines_after = 1

[[rules]]
id = "log.secret.basic_auth"
pattern = '(?i)\bBasic\s+[A-Za-z0-9+/=]{20,}\b'
description = "Basic auth payload (base64)"
severity = "high"
score = 82
base_score = 82
category = "secret"
tags = ["log", "secret", "authz", "basic"]
placeholder = "<REDACTED:SECRET>"
context_lines_before = 1
context_lines_after = 1

[[rules]]
id = "log.secret.keyvalue.password"
pattern = '''(?i)\b(?:password|passwd|pwd|secret|client_secret|api[_-]?key|access[_-]?token|refresh[_-]?token|auth[_-]?token)\b\s*[:=]\s*["'']?[A-Za-z0-9._~+/=-]{8,}["'']?'''
description = "Key-value secrets (password/token/apiKey style)"
severity = "high"
score = 80
base_score = 80
category = "secret"
tags = ["log", "secret", "kv"]
placeholder = "<REDACTED:SECRET>"
context_lines_before = 1
context_lines_after = 1

[[rules]]
id = "log.secret.aws.access_key_id"
pattern = '\b(AKIA|ASIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA)[0-9A-Z]{16}\b'
description = "AWS Access Key ID"
severity = "high"
score = 85
base_score = 85
category = "secret"
tags = ["log", "secret", "aws", "credential"]
placeholder = "<REDACTED:SECRET>"
context_lines_before = 1
context_lines_after = 1

[[rules]]
id = "log.secret.google.api_key"
pattern = '\bAIza[0-9A-Za-z\-_]{35}\b'
description = "Google API key (AIza...)"
severity = "high"
score = 85
base_score = 85
category = "secret"
tags = ["log", "secret", "google", "api_key"]
placeholder = "<REDACTED:SECRET>"
context_lines_before = 1
context_lines_after = 1

[[rules]]
id = "log.secret.private_key.block"
pattern = '-----BEGIN (?:RSA|EC|OPENSSH|DSA|PGP) PRIVATE KEY-----'
description = "Private key header block"
severity = "critical"
score = 95
base_score = 95
category = "secret"
tags = ["log", "secret", "private_key"]
placeholder = "<REDACTED:SECRET>"
context_lines_before = 1
context_lines_after = 1

[[rules]]
id = "log.secret.cloudflare.token"
pattern = '''(?i)\b(?:CF_API_TOKEN|CLOUDFLARE_API_TOKEN)\b\s*[:=]\s*["'']?[A-Za-z0-9._~+/=-]{20,}["'']?'''
description = "Cloudflare API token assignment"
severity = "high"
score = 85
base_score = 85
category = "secret"
tags = ["log", "secret", "cloudflare", "token"]
placeholder = "<REDACTED:SECRET>"
context_lines_before = 1
context_lines_after = 1
