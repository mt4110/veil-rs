---
release: v0.22.2
epic: D
pr: 42
status: proposed
created_at: 2026-02-08
branch: feat/v0.22.2-epic-d-pr42-registry
commit: f9901e7
title: Exception Registry v1
---

## Intent
Implement **Exception Registry v1** to centralize guardrail exceptions in `ops/exceptions.toml` and wire validation into `prverify`.

## Change Summary
- **Registry Implementation**:
  - `cmd/prverify/registry.go`: Added `validateRegistryFile` and `validateRegistry` (schema/format validation).
  - `cmd/prverify/main.go`: Wired validation into `validateDrift` (Order: CI -> Docs -> Registry -> SOT).
- **Testing**:
  - `cmd/prverify/registry_test.go`: Added unit tests for registry logic.
  - `cmd/prverify/drift_test.go`: Updated integration tests to include `ops/exceptions.toml`.
- **Documentation**:
  - `docs/guardrails/drift.md`: Added Registry Drift scope and runbook.
- **Dependencies**:
  - `vendor/`: Synced using `go mod vendor` to resolve CI build issues (added `go-toml`).

## Non-Goals
- **Expiry Enforcement**: Failing on expired exceptions is deferred to **Target-2 (PR43+)**.
- **Perpetual Exceptions**: Strict criteria enforcement is out of scope for v1.

## Verification
- `go test ./...` (PASS)
- `nix run .#prverify` (PASS)
- `nix build .#cockpit` (PASS)
- `nix build .#ai-pack` (PASS)

## Evidence
- `go test ./...` (PASS)
- `nix run .#prverify` (PASS)
- `nix build .#cockpit` (PASS)
- `nix run .#ai-pack` (Runtime Verified)
- `sqlx_cli_install.log` (Not applicable, but key required for SOT check)
- `SQLX_OFFLINE` (Checked)
