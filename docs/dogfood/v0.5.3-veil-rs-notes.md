# veil-rs Dogfooding Notes (v0.5.3 / Session 5)

## Summary
- **Scan Date**: 2025-12-09
- **Scope**: `crates`, `tests`, `examples`, `scripts`, `docs` (excluding `target`)
- **Method**: Manual `find | xargs veil scan` due to directory scan bug.
- **Total Files**: 111 (via find)
- **Findings**: 34
- **Cleanliness**: 100% Clean (No findings in actual `src/` code).

## Critical Issues Discovered
### 1. **Directory Scan Hang (WalkBuilder)**
- **Symptom**: `veil scan crates/veil-core/tests` hangs indefinitely.
- **Observations**:
  - Scanning individual files works (`veil scan file1 file2`).
  - Scanning with `limit=3` worked globally (likely hit `tests/contracts` early).
  - Scanning with `RAYON_NUM_THREADS=1` still hangs on directory.
  - Scanning with explicit file list (xargs) works perfectly.
- **Suspected Cause**: `ignore::WalkBuilder` interaction with `flat_map` pipeline, possibly related to `ScanLimit` check or iterator consumption order in `scan.rs`.
- **Action**: Needs urgent fix in Session 6 or bugfix session.

## Findings Analysis

### True Positives (TP)
None found in source code (Good!).

### Intended Test Data
All 34 findings were in `tests/` or related documentation `docs/`:
- `crates/veil-cli/tests/contracts/simple-project/src/main.rs`: AWS Access Key (Golden File fixture)
- `tests/data/creds_aws_access_key_hit.txt`: AWS Access Key (Test data)
- `tests/data/jp_mynumber_hit.txt`: My Number (Test data)
- ... and other fixture files.

### False Positives (FP)
None detected in this round.
- This suggests the default rules are reasonably conservative or `veil-rs` codebase is very clean.
- Future rounds should test against messier codebases (e.g. older JS projects).

## Next Steps
1. **Fix Hang**: Prioritize debugging `Default FS Scan` iterator logic in `veil-cli`.
2. **Rule Tuning**: Current rules seem safe for Rust code. No immediate tuning needed based on this repo.
