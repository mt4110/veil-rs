warning: unused import: `body_json`
 --> crates/veil-guardian/tests/yarn_integration.rs:5:26
  |
5 | use wiremock::matchers::{body_json, method, path};
  |                          ^^^^^^^^^
  |
  = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: `veil-guardian` (test "yarn_integration") generated 1 warning (run `cargo fix --test "yarn_integration" -p veil-guardian` to apply 1 suggestion)
    Finished `test` profile [unoptimized + debuginfo] target(s) in 0.11s
     Running unittests src/lib.rs (target/debug/deps/veil_guardian-9c2777da211e5cbb)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 7 filtered out; finished in 0.00s

     Running tests/basic.rs (target/debug/deps/basic-746b2ffd69abc08e)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 3 filtered out; finished in 0.00s

     Running tests/npm_integration.rs (target/debug/deps/npm_integration-a0941df7783581b0)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 1 filtered out; finished in 0.00s

     Running tests/pnpm_integration.rs (target/debug/deps/pnpm_integration-5da34aed783e61e5)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 1 filtered out; finished in 0.00s

     Running tests/yarn_integration.rs (target/debug/deps/yarn_integration-7672e55d68fcabd1)

running 1 test

thread 'test_yarn_integration' (100354825) panicked at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/blocking/shutdown.rs:51:21:
Cannot drop a runtime in a context where blocking is not allowed. This happens when a runtime is dropped from within an asynchronous context.
stack backtrace:
   0: __rustc::rust_begin_unwind
             at /rustc/ba86c0460b0233319e01fd789a42a7276eade805/library/std/src/panicking.rs:689:5
   1: core::panicking::panic_fmt
             at /rustc/ba86c0460b0233319e01fd789a42a7276eade805/library/core/src/panicking.rs:80:14
   2: <tokio::runtime::blocking::shutdown::Receiver>::wait
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/blocking/shutdown.rs:51:21
   3: <tokio::runtime::blocking::pool::BlockingPool>::shutdown
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/blocking/pool.rs:263:29
   4: <tokio::runtime::blocking::pool::BlockingPool as core::ops::drop::Drop>::drop
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/blocking/pool.rs:284:14
   5: core::ptr::drop_in_place::<tokio::runtime::blocking::pool::BlockingPool>
             at /nix/store/rhdirxwm8sv533dcrjxq2jskjxnlqp6r-rust-default-1.94.0-nightly-2025-12-07/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:805:1
   6: core::ptr::drop_in_place::<tokio::runtime::runtime::Runtime>
             at /nix/store/rhdirxwm8sv533dcrjxq2jskjxnlqp6r-rust-default-1.94.0-nightly-2025-12-07/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:805:1
   7: reqwest::blocking::wait::enter
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-0.12.24/src/blocking/wait.rs:80:21
   8: reqwest::blocking::wait::timeout::<tokio::sync::oneshot::Receiver<core::result::Result<(), reqwest::error::Error>>, core::result::Result<(), reqwest::error::Error>, tokio::sync::oneshot::error::RecvError>
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-0.12.24/src/blocking/wait.rs:13:5
   9: <reqwest::blocking::client::ClientHandle>::new
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-0.12.24/src/blocking/client.rs:1417:15
  10: <reqwest::blocking::client::ClientBuilder>::build
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-0.12.24/src/blocking/client.rs:116:9
  11: <reqwest::blocking::client::Client>::new
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-0.12.24/src/blocking/client.rs:1219:30
  12: <veil_guardian::providers::osv::client::OsvClient>::new
             at ./src/providers/osv/client.rs:58:21
  13: veil_guardian::scanner::scan_yarn
             at ./src/scanner.rs:99:18
  14: veil_guardian::scanner::scan_lockfile
             at ./src/scanner.rs:28:16
  15: yarn_integration::test_yarn_integration::{closure#0}
             at ./tests/yarn_integration.rs:72:18
  16: <core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>> as core::future::future::Future>::poll
             at /nix/store/rhdirxwm8sv533dcrjxq2jskjxnlqp6r-rust-default-1.94.0-nightly-2025-12-07/lib/rustlib/src/rust/library/core/src/future/future.rs:133:9
  17: <core::pin::Pin<&mut core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>> as core::future::future::Future>::poll
             at /nix/store/rhdirxwm8sv533dcrjxq2jskjxnlqp6r-rust-default-1.94.0-nightly-2025-12-07/lib/rustlib/src/rust/library/core/src/future/future.rs:133:9
  18: <tokio::runtime::scheduler::current_thread::CoreGuard>::block_on::<core::pin::Pin<&mut core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>>::{closure#0}::{closure#0}::{closure#0}
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/scheduler/current_thread/mod.rs:742:70
  19: tokio::task::coop::with_budget::<core::task::poll::Poll<()>, <tokio::runtime::scheduler::current_thread::CoreGuard>::block_on<core::pin::Pin<&mut core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>>::{closure#0}::{closure#0}::{closure#0}>
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/task/coop/mod.rs:167:5
  20: tokio::task::coop::budget::<core::task::poll::Poll<()>, <tokio::runtime::scheduler::current_thread::CoreGuard>::block_on<core::pin::Pin<&mut core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>>::{closure#0}::{closure#0}::{closure#0}>
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/task/coop/mod.rs:133:5
  21: <tokio::runtime::scheduler::current_thread::CoreGuard>::block_on::<core::pin::Pin<&mut core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>>::{closure#0}::{closure#0}
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/scheduler/current_thread/mod.rs:742:25
  22: <tokio::runtime::scheduler::current_thread::Context>::enter::<core::task::poll::Poll<()>, <tokio::runtime::scheduler::current_thread::CoreGuard>::block_on<core::pin::Pin<&mut core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>>::{closure#0}::{closure#0}>
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/scheduler/current_thread/mod.rs:432:19
  23: <tokio::runtime::scheduler::current_thread::CoreGuard>::block_on::<core::pin::Pin<&mut core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>>::{closure#0}
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/scheduler/current_thread/mod.rs:741:44
  24: <tokio::runtime::scheduler::current_thread::CoreGuard>::enter::<<tokio::runtime::scheduler::current_thread::CoreGuard>::block_on<core::pin::Pin<&mut core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>>::{closure#0}, core::option::Option<()>>::{closure#0}
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/scheduler/current_thread/mod.rs:829:68
  25: <tokio::runtime::context::scoped::Scoped<tokio::runtime::scheduler::Context>>::set::<<tokio::runtime::scheduler::current_thread::CoreGuard>::enter<<tokio::runtime::scheduler::current_thread::CoreGuard>::block_on<core::pin::Pin<&mut core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>>::{closure#0}, core::option::Option<()>>::{closure#0}, (alloc::boxed::Box<tokio::runtime::scheduler::current_thread::Core>, core::option::Option<()>)>
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/context/scoped.rs:40:9
  26: tokio::runtime::context::set_scheduler::<(alloc::boxed::Box<tokio::runtime::scheduler::current_thread::Core>, core::option::Option<()>), <tokio::runtime::scheduler::current_thread::CoreGuard>::enter<<tokio::runtime::scheduler::current_thread::CoreGuard>::block_on<core::pin::Pin<&mut core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>>::{closure#0}, core::option::Option<()>>::{closure#0}>::{closure#0}
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/context.rs:176:38
  27: <std::thread::local::LocalKey<tokio::runtime::context::Context>>::try_with::<tokio::runtime::context::set_scheduler<(alloc::boxed::Box<tokio::runtime::scheduler::current_thread::Core>, core::option::Option<()>), <tokio::runtime::scheduler::current_thread::CoreGuard>::enter<<tokio::runtime::scheduler::current_thread::CoreGuard>::block_on<core::pin::Pin<&mut core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>>::{closure#0}, core::option::Option<()>>::{closure#0}>::{closure#0}, (alloc::boxed::Box<tokio::runtime::scheduler::current_thread::Core>, core::option::Option<()>)>
             at /nix/store/rhdirxwm8sv533dcrjxq2jskjxnlqp6r-rust-default-1.94.0-nightly-2025-12-07/lib/rustlib/src/rust/library/std/src/thread/local.rs:513:12
  28: <std::thread::local::LocalKey<tokio::runtime::context::Context>>::with::<tokio::runtime::context::set_scheduler<(alloc::boxed::Box<tokio::runtime::scheduler::current_thread::Core>, core::option::Option<()>), <tokio::runtime::scheduler::current_thread::CoreGuard>::enter<<tokio::runtime::scheduler::current_thread::CoreGuard>::block_on<core::pin::Pin<&mut core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>>::{closure#0}, core::option::Option<()>>::{closure#0}>::{closure#0}, (alloc::boxed::Box<tokio::runtime::scheduler::current_thread::Core>, core::option::Option<()>)>
             at /nix/store/rhdirxwm8sv533dcrjxq2jskjxnlqp6r-rust-default-1.94.0-nightly-2025-12-07/lib/rustlib/src/rust/library/std/src/thread/local.rs:477:20
  29: tokio::runtime::context::set_scheduler::<(alloc::boxed::Box<tokio::runtime::scheduler::current_thread::Core>, core::option::Option<()>), <tokio::runtime::scheduler::current_thread::CoreGuard>::enter<<tokio::runtime::scheduler::current_thread::CoreGuard>::block_on<core::pin::Pin<&mut core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>>::{closure#0}, core::option::Option<()>>::{closure#0}>
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/context.rs:176:17
  30: <tokio::runtime::scheduler::current_thread::CoreGuard>::enter::<<tokio::runtime::scheduler::current_thread::CoreGuard>::block_on<core::pin::Pin<&mut core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>>::{closure#0}, core::option::Option<()>>
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/scheduler/current_thread/mod.rs:829:27
  31: <tokio::runtime::scheduler::current_thread::CoreGuard>::block_on::<core::pin::Pin<&mut core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>>
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/scheduler/current_thread/mod.rs:729:24
  32: <tokio::runtime::scheduler::current_thread::CurrentThread>::block_on::<core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>::{closure#0}
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/scheduler/current_thread/mod.rs:200:33
  33: tokio::runtime::context::runtime::enter_runtime::<<tokio::runtime::scheduler::current_thread::CurrentThread>::block_on<core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>::{closure#0}, ()>
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/context/runtime.rs:65:16
  34: <tokio::runtime::scheduler::current_thread::CurrentThread>::block_on::<core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/scheduler/current_thread/mod.rs:188:9
  35: <tokio::runtime::runtime::Runtime>::block_on_inner::<core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/runtime.rs:368:52
  36: <tokio::runtime::runtime::Runtime>::block_on::<core::pin::Pin<&mut dyn core::future::future::Future<Output = ()>>>
             at /Users/masakitakemura/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/tokio-1.48.0/src/runtime/runtime.rs:342:18
  37: yarn_integration::test_yarn_integration
             at ./tests/yarn_integration.rs:93:12
  38: yarn_integration::test_yarn_integration::{closure#0}
             at ./tests/yarn_integration.rs:9:33
  39: <yarn_integration::test_yarn_integration::{closure#0} as core::ops::function::FnOnce<()>>::call_once
             at /nix/store/rhdirxwm8sv533dcrjxq2jskjxnlqp6r-rust-default-1.94.0-nightly-2025-12-07/lib/rustlib/src/rust/library/core/src/ops/function.rs:250:5
  40: <fn() -> core::result::Result<(), alloc::string::String> as core::ops::function::FnOnce<()>>::call_once
             at /rustc/ba86c0460b0233319e01fd789a42a7276eade805/library/core/src/ops/function.rs:250:5
note: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.
test test_yarn_integration ... FAILED

failures:

failures:
    test_yarn_integration

test result: FAILED. 0 passed; 1 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.04s

error: test failed, to rerun pass `-p veil-guardian --test yarn_integration`
