# Veil-rs v1.0.0 Release Notes üéâ

Welcome to **Veil v1.0.0**, our first stable release for production-grade CI/CD **secret + PII scanning**.

This release formalizes the CLI contract, guarantees machine-output purity for automation pipelines, and adds guardrails (hard limits + diagnostics) to protect your infrastructure.

## ‚ö†Ô∏è Breaking Changes & Contract Freeze

To ensure CI stability, we have frozen the CLI contract and exit codes.

- **Strict Exit Codes**
  - `0`: Scan completed successfully (no policy violations).
  - `1`: Policy violation (findings exceeded configured fail thresholds, e.g. score/severity thresholds).
  - `2`: Tool error or incomplete scan (e.g. scan limits reached, invalid configuration, baseline errors).

- **Machine Output Purity**
  All warning/progress messages (e.g. "Scanning...", truncation warnings, baseline write notices) are now sent to `stderr`.
  Running `veil scan --format json > report.json` will **never** corrupt the output file with text warnings.

## ‚ú® New / Notable Improvements

### 1) Hardened Config Boundaries (Fail-Fast Limits)
A rogue scan running on massive auto-generated directories will no longer silently hang or pass incorrectly.

- `max_file_count` is strictly validated and enforced.
- `max_file_size` and `max_findings` are strictly validated as safety boundaries.
- Reaching any scan limit stops the scan and returns **Exit Code 2** to prevent false-green CI passes.
- Machine outputs remain valid even on limit-triggered failures (warnings stay on `stderr`).

### 2) Organization Config Layering (`VEIL_ORG_CONFIG`)
Organizations can enforce unified security standards by pointing `VEIL_ORG_CONFIG` to a centralized `org.toml`.
Veil merges Org/User/Repo configurations into the effective runtime config.

> Note: `VEIL_ORG_RULES` is deprecated in favor of `VEIL_ORG_CONFIG`.

### 3) Veil Doctor (`veil doctor`)
A new diagnostic command to help you understand runtime behavior quickly:
- OS / toolchain info
- Loaded configuration layers (Org/User/Repo)
- Effective limit boundaries
- RulePack status
- Guardian (OSV) cache status and related environment variables

### 4) Refined Init Profiles
`veil init --profile Logs` generates a built-in log scrubbing RulePack template directly into your project.

## üõ°Ô∏è Security Hardening
- Regex rules over 1024 characters are rejected during validation to prevent excessive compile/memory overhead.
  Validate your config with `veil config check`.

---

### Upgrade
`cargo install --locked --git https://github.com/mt4110/veil-rs.git --tag v1.0.0 veil-cli`
