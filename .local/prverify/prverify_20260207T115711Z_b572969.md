# PR verify report

このレポートは `nix run .#prverify` の実行結果です。

## Environment

- timestamp (UTC): 20260207T115711Z
- git sha: b572969
- rustc: rustc 1.92.0 (ded5c06cf 2025-12-08)
- cargo: cargo 1.92.0 (344c4567c 2025-10-21)
- go: go version go1.24.11 darwin/arm64

## Commands
```bash
cargo test -p veil-cli --test cli_tests
cargo test --workspace
go run ./cmd/prverify
```

## cli smoke (trycmd)
```
    Finished `test` profile [unoptimized + debuginfo] target(s) in 0.17s
     Running tests/cli_tests.rs (target/debug/deps/cli_tests-f8b8fe88163df2fc)

running 1 test
Testing tests/cmd/smoke_version.toml ... ok 959ms 385us 583ns
Testing tests/cmd/help.toml ... ok 1s 52ms 285us 834ns
Testing tests/cmd/smoke_config_check.toml ... ok 1s 52ms 364us 208ns
Testing tests/cmd/smoke_filter.toml ... ok 1s 56ms 293us 625ns
Testing tests/cmd/smoke_mask_dryrun.toml ... ok 1s 58ms 821us 750ns
Testing tests/cmd/smoke_scan_json.toml ... ok 1s 62ms 138us 750ns
test cli_tests ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 1.06s

```

- exit_code: 0

## workspace tests
```
    Finished `test` profile [unoptimized + debuginfo] target(s) in 0.30s
     Running unittests src/main.rs (target/debug/deps/veil-263ef350d2744850)

running 8 tests
test formatters::json::tests::test_json_output ... ok
test formatters::markdown::tests::test_markdown_output ... ok
 Severity | Score | Rule ID   | File     | Line | Match 
----------+-------+-----------+----------+------+-------
 High     | 80    | test_rule | test.txt | 1    | 123 
test formatters::table::tests::test_table_output ... ok
test commands::init::tests::test_build_config_standard ... ok
test commands::triage::tests::test_add_ignore_path_creates_structure ... ok
test commands::triage::tests::test_add_ignore_path_preserves_comments ... ok
test config_loader::tests::test_repo_only_config ... ok
test formatters::html::tests::test_html_generation ... ok

test result: ok. 8 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.02s

     Running tests/baseline_apply_test.rs (target/debug/deps/baseline_apply_test-0ecb56301b997869)

running 2 tests
test test_baseline_error_conditions ... ok
test test_baseline_application_flow ... ok

test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 1.24s

     Running tests/baseline_error_test.rs (target/debug/deps/baseline_error_test-067d5715816e0ffb)

running 3 tests
test test_empty_baseline_file ... ok
test test_corrupt_baseline_file ... ok
test test_missing_baseline_file ... ok

test result: ok. 3 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.10s

     Running tests/baseline_test.rs (target/debug/deps/baseline_test-93156f83a84e2243)

running 2 tests
test baseline_argument_conflicts_with_write_baseline ... ok
test write_baseline_creates_file_with_schema ... ok

test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.11s

     Running tests/baseline_ux_test.rs (target/debug/deps/baseline_ux_test-f15ee635a1359826)

running 4 tests
test test_ux_case_a_clean ... ok
test test_ux_case_b_suppressed_clean ... ok
test test_ux_case_d_json_schema ... ok
test test_ux_case_c_dirty ... ok

test result: ok. 4 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.32s

     Running tests/binary_large_test.rs (target/debug/deps/binary_large_test-038cb09968534836)

running 1 test
test test_binary_and_large_files ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.11s

     Running tests/ci_flags_test.rs (target/debug/deps/ci_flags_test-36b51e12d8717631)

running 2 tests
test test_fail_on_score ... ok
test test_fail_on_severity ... ok

test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.42s

     Running tests/cli_tests.rs (target/debug/deps/cli_tests-247035b1311bc8b4)

running 1 test
Testing tests/cmd/smoke_version.toml ... ok 11ms 551us 875ns
Testing tests/cmd/help.toml ... ok 12ms 996us 458ns
Testing tests/cmd/smoke_config_check.toml ... ok 101ms 890us 917ns
Testing tests/cmd/smoke_filter.toml ... ok 104ms 994us
Testing tests/cmd/smoke_mask_dryrun.toml ... ok 107ms 82us 750ns
Testing tests/cmd/smoke_scan_json.toml ... ok 111ms 486us
test cli_tests ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.12s

     Running tests/config_dump_test.rs (target/debug/deps/config_dump_test-8a24d7b026f9a918)

running 6 tests
test config_dump_org_is_empty_by_default ... ok
test config_dump_toml_format ... ok
test config_dump_org_env_explicit ... ok
test config_dump_user_xdg_implicit ... ok
test config_dump_repo_and_effective_json ... ok
test config_layer_precedence ... ok

test result: ok. 6 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.02s

     Running tests/exit_code_test.rs (target/debug/deps/exit_code_test-9fc1f4af8e747533)

running 1 test
test test_exit_code_behavior ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.31s

     Running tests/filter_config_test.rs (target/debug/deps/filter_config_test-bc1efd8a5888137f)

running 4 tests
test test_filter_exit_code_zero ... ok
test test_filter_config_default_placeholder ... ok
test test_filter_config_rule_override ... ok
test test_filter_config_custom_placeholder ... ok

test result: ok. 4 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.10s

     Running tests/filter_rules_pack_test.rs (target/debug/deps/filter_rules_pack_test-3ab71cb80851e7af)

running 2 tests
test test_filter_load_rules_pack ... ok
test test_filter_load_rules_pack_jp ... ok

test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.24s

     Running tests/html_baseline_test.rs (target/debug/deps/html_baseline_test-e4d081f2b3c9537b)

running 1 test
test test_html_report_baseline_integration ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.23s

     Running tests/html_report_test.rs (target/debug/deps/html_report_test-e6a6a860639bfea6)

running 1 test
test html_report_contains_metadata_and_interactive_elements ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.13s

     Running tests/init_log_pack_test.rs (target/debug/deps/init_log_pack_test-65bedf7a630d4570)

running 2 tests
test test_init_app_profile_defaults ... ok
test test_init_logs_profile_generates_pack ... ok

test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.39s

     Running tests/init_test.rs (target/debug/deps/init_test-1fb14334f60108a0)

running 3 tests
test test_init_ci_unsupported ... ok
test test_init_ci_github ... ok
test test_init_ci_github_pinned_none ... ok

test result: ok. 3 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.01s

     Running tests/json_contract_tests.rs (target/debug/deps/json_contract_tests-c83934a6168496da)

running 1 test
test json_contract_simple_project_matches_golden_file ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.12s

     Running tests/json_schema_version_test.rs (target/debug/deps/json_schema_version_test-25ed709fcbd76d61)

running 1 test
test test_json_output_has_schema_version ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.10s

     Running tests/policy_test.rs (target/debug/deps/policy_test-f1d01e4e1606321d)

running 3 tests
test test_policy_layering_override ... ok
test test_policy_layering_ignore_extend ... ok
test test_policy_layering_fail_score ... ok

test result: ok. 3 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.22s

     Running tests/precommit_test.rs (target/debug/deps/precommit_test-a4332d0b214ffd2a)

running 1 test
test test_pre_commit_init ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.04s

     Running tests/rules_test.rs (target/debug/deps/rules_test-22fde0fa1a620498)

running 4 tests
test rules_explain_invalid_fails ... ok
test rules_explain_shows_details ... ok
test rules_list_severity_filter ... ok
test rules_list_shows_known_rule ... ok

test result: ok. 4 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.10s

     Running tests/scan_hang_test.rs (target/debug/deps/scan_hang_test-18fcbb140c892eea)

running 1 test
test scan_directory_terminates_ok ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.10s

     Running tests/sot_new_test.rs (target/debug/deps/sot_new_test-53a5c598d4c4a7d7)

running 3 tests
test test_sot_new_slug_dry_run ... ok
test test_sot_new_success ... ok
test test_sot_new_force ... ok

test result: ok. 3 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.05s

     Running tests/sot_rename_test.rs (target/debug/deps/sot_rename_test-437d172cedbbe536)

running 3 tests
test test_sot_rename_multiple_candidates_requires_path ... ok
test test_sot_rename_dry_run ... ok
test test_sot_rename_success_autodetect ... ok

test result: ok. 3 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.01s

     Running tests/staged_test.rs (target/debug/deps/staged_test-60b463964b067a68)

running 2 tests
test test_staged_scan ... ok
test test_fail_score_env ... ok

test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.21s

     Running unittests src/lib.rs (target/debug/deps/veil_config-8ee82fd5a0ae1430)

running 2 tests
test validate::tests::test_valid_modes ... ok
test validate::tests::test_fail_fast_plain_mode ... ok

test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running unittests src/lib.rs (target/debug/deps/veil_core-0a8a3bbcde7d99a3)

running 28 tests
test masking::tests::test_mask_partial_short ... ok
test masking::tests::test_mask_custom_placeholder ... ok
test masking::tests::test_mask_ranges_adjacent ... ok
test masking::tests::test_mask_ranges_nested ... ok
test masking::tests::test_mask_ranges_overlapping ... ok
test masking::tests::test_mask_spans_multi_component ... ok
test masking::tests::test_mask_ranges_simple ... ok
test baseline::tests::test_apply_baseline_none ... ok
test masking::tests::test_mask_partial ... ok
test masking::tests::test_plain_mode_returns_original ... ok
test baseline::tests::test_apply_baseline_empty_snapshot ... ok
test baseline::tests::test_apply_baseline_empty_findings ... ok
test baseline::tests::fingerprint_is_stable_for_same_input ... ok
test masking::tests::test_mask_spans_same_priority ... ok
test masking::tests::test_mask_spans_obs_pii_overlap ... ok
test masking::tests::test_mask_spans_priority_overlap ... ok
test baseline::tests::test_apply_baseline_partitioning ... ok
test baseline::tests::test_apply_baseline_duplicates ... ok
test baseline::tests::snapshot_roundtrip_json ... ok
test summary::v1::tests::test_summary_serialization ... ok
test scanner::tests::test_context_capture ... ok
test scanner::tests::test_context_capture_start_of_file ... ok
test scanner::tests::test_inline_ignore ... ok
test rules::pack::tests::test_load_auto_order ... ok
test rules::pack::tests::test_load_manifest_order ... ok
test rules::pack::tests::test_duplicate_id_error ... ok
test scoring::tests::test_base_score_default ... ok
test scoring::tests::test_context_modifiers ... ok

test result: ok. 28 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.01s

     Running tests/dogfood_schema.rs (target/debug/deps/dogfood_schema-9921f47d8dbf8dcf)

running 2 tests
test test_metrics_schema_validity ... ok
test test_worklist_schema_validity ... ok

test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.01s

     Running tests/dos_safety.rs (target/debug/deps/dos_safety-5c3db50c117b115e)

running 2 tests
test test_many_matches_dos ... ok
test test_large_input_performance ... ok

test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.10s

     Running tests/golden_metrics.rs (target/debug/deps/golden_metrics-8a3b6e4a1d879e71)

running 1 test
test test_golden_metrics_deterministic_output ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running tests/rule_tests.rs (target/debug/deps/rule_tests-8b81f2cddc4eb629)

running 3 tests
test fake_slack_tokens_have_expected_format ... ok
test rule_creds_slack_token_legacy_detects_dynamic_tokens ... ok
test test_rules_from_fixtures ... ok

test result: ok. 3 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.14s

     Running unittests src/lib.rs (target/debug/deps/veil_guardian-c895e128b20bfd42)

running 11 tests
test providers::npm::tests::test_extract_name ... ok
test providers::yarn::tests::test_parse_package_name ... ok
test providers::pnpm::tests::test_parse_v9_at_style ... ok
test providers::yarn::tests::test_berry_parsing_valid ... ok
test providers::yarn::tests::test_berry_parsing_skips_protocols ... ok
test providers::yarn::tests::test_classic_parsing ... ok
test providers::yarn::tests::test_classic_skips_protocols ... ok
test providers::yarn::tests::test_classic_header_quote_aware_split ... ok
test providers::pnpm::tests::test_parse_v6_slash_style ... ok
test providers::osv::details_store::tests::cache_roundtrip_with_etag ... ok
test providers::osv::details_store::tests::test_load_legacy_format_path_check ... ok

test result: ok. 11 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.02s

     Running tests/atomic_write.rs (target/debug/deps/atomic_write-227954bdca0cd16d)

running 4 tests
test test_no_tmp_leftovers ... ok
test test_atomic_write_creates_file ... ok
test test_atomic_write_creates_parent_dir ... ok
test test_atomic_write_overwrites_existing ... ok

test result: ok. 4 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.04s

     Running tests/basic.rs (target/debug/deps/basic-3153deff96614ff9)

running 3 tests
test test_load_builtin ... ok
test test_check_vulnerabilities ... ok
test test_version_match ... ok

test result: ok. 3 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running tests/coalescing.rs (target/debug/deps/coalescing-d678821042a38c13)

running 2 tests
test test_querybatch_coalesces_in_flight ... ok
test test_details_coalesces_in_flight ... ok

test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 3.10s

     Running tests/contract_osv_fixtures.rs (target/debug/deps/contract_osv_fixtures-02dc9bc70c5daf6d)

running 1 test
test test_contract_osv_fixtures ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running tests/file_lock.rs (target/debug/deps/file_lock-6a1a22a7d8276ac1)

running 2 tests
test test_lock_file_creation ... ok
test test_concurrent_writes_are_safe ... ok

test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.16s

     Running tests/guardian_next_retry.rs (target/debug/deps/guardian_next_retry-54a1d36e2c15474f)

running 1 test
test retry_on_500_then_success ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.10s

     Running tests/guardian_next_singleflight.rs (target/debug/deps/guardian_next_singleflight-3c51018f355b60f2)

running 1 test
test singleflight_runs_only_once ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.05s

     Running tests/key_versioning.rs (target/debug/deps/key_versioning-494d792a45972f47)

running 6 tests
test test_normalize_key_safe_chars ... ok
test test_normalize_key_truncation ... ok
test test_normalize_key_collision_avoidance ... ok
test test_complex_id_roundtrip_with_etag ... ok
test test_legacy_fallback ... ok
test test_directory_conflict ... ok

test result: ok. 6 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.08s

     Running tests/live_osv_api.rs (target/debug/deps/live_osv_api-e7e3fbedbc155f01)

running 1 test
test test_live_osv_lodash_check ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running tests/metrics.rs (target/debug/deps/metrics-f9189d32d3aff119)

running 1 test
test test_metrics_collection ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.10s

     Running tests/npm_integration.rs (target/debug/deps/npm_integration-ef1edddf6e667613)

running 1 test
test test_npm_integration ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.08s

     Running tests/osv_concurrency.rs (target/debug/deps/osv_concurrency-d855f29ce1530081)

running 1 test
test respects_max_in_flight_concurrency_gate ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 2.12s

     Running tests/osv_details_flow.rs (target/debug/deps/osv_details_flow-b2bfe2388ef27b25)

running 3 tests
test test_osv_details_offline_uses_stale ... ok
test test_osv_details_flow_fresh_skips_fetch ... ok
test test_osv_details_flow_expired_triggers_fetch ... ok

test result: ok. 3 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.10s

     Running tests/osv_operator_ux.rs (target/debug/deps/osv_operator_ux-0fd6612b13fe70ed)

running 2 tests
test test_operator_message_offline_remediation ... ok
test test_operator_message_includes_quarantine_note ... ok

test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.09s

     Running tests/osv_retry.rs (target/debug/deps/osv_retry-38ab94f7d2fed419)

running 3 tests
test retry_on_500_records_backoff_sleeps ... ok
test retry_after_exceeds_budget_fails_fast ... ok
test retry_after_is_respected ... ok

test result: ok. 3 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.09s

     Running tests/osv_retry_metrics.rs (target/debug/deps/osv_retry_metrics-e71cd7a4e5e4fa37)

running 1 test
test verify_metrics_on_retry_and_success ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.09s

     Running tests/pnpm_integration.rs (target/debug/deps/pnpm_integration-c2c598acebf751fd)

running 1 test
test test_pnpm_integration ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.09s

     Running tests/report_output.rs (target/debug/deps/report_output-8e177a625308f338)

running 3 tests
test test_report_grouping_logic ... ok
test test_report_output_duplicates ... ok
test test_report_output_deterministic ... ok

test result: ok. 3 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.12s

     Running tests/yarn_integration.rs (target/debug/deps/yarn_integration-a1b17d0a44ee4a99)

running 1 test
test test_yarn_integration ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.07s

     Running unittests src/main.rs (target/debug/deps/veil_server-77540e6d8c40c605)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

   Doc-tests veil_config

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

   Doc-tests veil_core

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

   Doc-tests veil_guardian

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

```

- exit_code: 0

## Drift Check (Go)
```
==> cargo test -p veil-cli --test cli_tests
    Finished `test` profile [unoptimized + debuginfo] target(s) in 0.17s
     Running tests/cli_tests.rs (target/debug/deps/cli_tests-f8b8fe88163df2fc)

running 1 test
Testing tests/cmd/smoke_version.toml ... ok 921ms 372us 833ns
Testing tests/cmd/help.toml ... ok 921ms 405us 625ns
Testing tests/cmd/smoke_config_check.toml ... ok 1s 15ms 838us 917ns
Testing tests/cmd/smoke_filter.toml ... ok 1s 20ms 862us 125ns
Testing tests/cmd/smoke_mask_dryrun.toml ... ok 1s 22ms 786us 167ns
Testing tests/cmd/smoke_scan_json.toml ... ok 1s 25ms 601us 667ns
test cli_tests ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 1.03s

==> Drift Check

-=======
Notes / Evidence

Local env:
- rustc: rustc 1.92.0 (ded5c06cf 2025-12-08)
- cargo: cargo 1.92.0 (344c4567c 2025-10-21)
- git: b5729691d49a (clean)

Tests:
- `cargo test -p veil-cli --test cli_tests` => OK (1.24s)
- `drift-check` => OK (0ms)

Rollback

Revert the merge/squash commit for this PR.
- Squash merge: `git revert <commit_sha>`
- Merge commit: `git revert -m 1 <merge_commit_sha>`
-=======
```

- exit_code: 0

## Notes / Evidence

- Local run: PASS

## Rollback

```bash
# 1コミットだけ戻す
git revert <commit>

# 範囲でまとめて戻す
git revert <oldest_commit>^..<newest_commit>
```

---
report: .local/prverify/prverify_20260207T115711Z_b572969.md
