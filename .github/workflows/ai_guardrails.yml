name: ai-guardrails

"on":
    pull_request:
        branches: [main, develop]
    push:
        branches: [main, develop]

jobs:
    mac-ghost:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4.1.7
            - name: Detect macOS ghosts (.DS_Store / AppleDouble)
              run: |
                  chmod +x scripts/ai_guardrails_check.sh
                  scripts/ai_guardrails_check.sh mac-ghost

    version-sync:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4.1.7
            - name: Check workspace + crate versions are consistent
              run: |
                  chmod +x scripts/ai_guardrails_check.sh
                  scripts/ai_guardrails_check.sh version-sync

    docs-ai-min:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4.1.7
            - name: Minimal docs/ai rules
              run: |
                  chmod +x scripts/ai_guardrails_check.sh
                  scripts/ai_guardrails_check.sh docs-ai-min

    ai-pack-smoke:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4.1.7
            - name: Ensure scripts/ai_pack.sh runs
              run: |
                  chmod +x scripts/ai_guardrails_check.sh
                  chmod +x scripts/ai_pack.sh
                  chmod +x scripts/publish_draft.sh
                  scripts/ai_guardrails_check.sh ai-pack-smoke

    json-syntax:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4.1.7
            - name: Validate cspell.json syntax
              run: |
                  chmod +x scripts/ai_guardrails_check.sh
                  scripts/ai_guardrails_check.sh json-syntax
